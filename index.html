<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebGraphics</title>

    <link rel="stylesheet" href="style.css">
    <script src="jquery-3.1.1.min.js"></script>

</head>
<body>

   <div id="start-div">
       <input type="button" value="Embedding" id="emb-btn">
       <input type="button" value="Extracting" id="extr-btn">
   </div>


    <div id="emb-div">
            <h2>Embedding</h2>
        <form method="post" action="/path-emb" id="embed-form" enctype="multipart/form-data">

            <input type="file" name="image-file">

            <fieldset>
                <legend>Color Channel</legend>
                <label>Red
                    <input type="radio" name="color-channel" value="r" checked>
                </label>

                <label>Green
                    <input type="radio" name="color-channel" value="g">
                </label>

                <label>Blue
                    <input type="radio" name="color-channel" value="b">
                </label>
            </fieldset>

            <label>Message
                <input type="text" name="message">
            </label>


            <input type="submit" value="Upload">
        </form>


            <div id="result-image-div"></div>
    </div>

    <div id="extr-div">
            <h2>Extracting</h2>
        <form method="post" action="/path-extr" id="extract-form" enctype="multipart/form-data">
            <input type="file" name="image-file2" multiple="multiple">

            <fieldset>
                <legend>Color Channel</legend>
                <label>Red
                    <input type="radio" name="color-channel-extr" value="r" checked>
                </label>

                <label>Green
                    <input type="radio" name="color-channel-extr" value="g">
                </label>

                <label>Blue
                    <input type="radio" name="color-channel-extr" value="b">
                </label>
            </fieldset>

            <input type="submit" value="Upload">
        </form>

        <div id="extracted-message-div"></div>
    </div>


    <script>
        $("#emb-btn").on("click", function () {
                $("#emb-div").show();
                $("#extr-div").hide();
                $("#start-div").hide();
        });

        $("#extr-btn").on("click", function () {
            $("#emb-div").hide();
            $("#extr-div").show();
            $("#start-div").hide();
        });


        $("#embed-form").on("submit", function (event) {
            event.preventDefault();

            var imageFile = $("input[name='image-file']");
            if(imageFile.val() == ""){
                alert("Image file wasn't selected");
                return false;
            }

            var message = $("input[name='message']").val();
            if(message == ""){
                alert("Message is absent");
                return false;
            }

            //get data from form inputs for AJAX request
            var fd = new FormData();
            fd.append("message", message);
            fd.append("color-channel", $("input[name='color-channel']:checked").val());
            fd.append("image-file", imageFile[0].files[0]);

            $.ajax({
                url: $(this).attr("action"),
                type: "post",
                processData: false,
                contentType: false,
                data: fd,
                success: function(data){
                    $("#result-image-div").html(data);
                },
                error: function () {
                    $("#result-image-div").text("Error")
                }
            });
        });


        $("#extract-form").on("submit", function (event) {
            event.preventDefault();

            var imageFile = $("input[name='image-file2']");
            if(imageFile.val() == ""){
                alert("Image file wasn't selected");
                return false;
            }

            //get data from form inputs for AJAX request
            var fd = new FormData();
            fd.append("image-file2", imageFile[0].files[0]);
            fd.append("color-channel-extr", $("input[name='color-channel-extr']:checked").val());

            $.ajax({
                url: $(this).attr("action"),
                type: "post",
                processData: false,
                contentType: false,
                data: fd,
                success: function(data){
                    $("#extracted-message-div").html(data);
                },
                error: function () {
                    $("#extracted-message-div").text("Error")
                }
            });
        });
    </script>

</body>
</html>